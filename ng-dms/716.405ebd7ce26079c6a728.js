(self.webpackChunkng_dms=self.webpackChunkng_dms||[]).push([[716],{3716:(t,n,e)=>{"use strict";e.r(n),e.d(n,{TinymceModule:()=>x});var i=e(8583),s=e(3423),o=e(1679),l=e(7716),c=e(8035),a=e(6595),r=e(1733),h=e(9101),d=e(9075),m=e(7606),u=e(1841);const p=["textarea"];let g=(()=>{class t{constructor(t,n,e,i){this.toolService=t,this.http=n,this.ngZone=e,this.elementRef=i,this.config={},this.defaultConfig={language:"zh_CN",height:320,placeholder:"\u5728\u8fd9\u91cc\u8fdb\u884c\u521b\u4f5c...",menubar:!1,plugins:"lists table hr link image media codesample code fullscreen searchreplace wordcount",toolbar_groups:{alignment:{icon:"align-left",tooltip:"alignment",items:"alignleft aligncenter alignright alignjustify"}},toolbar:"formatselect | forecolor backcolor bold italic underline strikethrough removeformat | lineheight alignment | hr blockquote numlist bullist table | link image media codesample | code fullscreen searchreplace wordcount"},this.editor=null,this.inited=new l.vpe,this.intervalId=null,this.prevBoundingClientRect={},this.loading=!1,this.html="",this.htmlChange=new l.vpe}get _config(){return Object.assign(Object.assign({target:this.textarea.nativeElement},this.defaultConfig),this.config)}ngOnChanges(t){t.html&&this.editor&&this.editor.getContent()!=this.html&&this.editor.setContent(this.html||"",{format:"html"})}ngOnInit(){}ngAfterViewInit(){this.toolService.require([{path:"./assets/lib/tinymce/tinymce.min.js"},{path:"./assets/lib/tinymce/bootstrap_tooltip/bootstrap_tooltip.min.css"},{path:"./assets/lib/tinymce/bootstrap_tooltip/bootstrap_tooltip.min.js",deps:[{path:"./assets/lib/tinymce/bootstrap_tooltip/jquery.min.js"}]}]).then(()=>{const t=window.jQuery;this.ngZone.runOutsideAngular(()=>{window.tinymce.init(this._config).then(([n])=>{this.editor=n,t.fn.tooltip.Constructor.DEFAULTS.container="body",t(".tox-toolbar-overlord [title]").tooltip({placement:"bottom"}),this.editor.on("paste",()=>{setTimeout(()=>{this.editor.uploadImages()},0)}),this.editor.on("input change",()=>{this.ngZone.run(()=>{this.html=this.editor.getContent(),this.htmlChange.emit(this.html)})}),this.editor.setContent(this.html||"",{format:"html"}),this.inited.emit(this.editor);let e=new window.ResizeObserver(t=>{let n=t[0].contentRect;if(0==this.prevBoundingClientRect.width&&n.width)return e.disconnect(),this.prevBoundingClientRect={},void this.reInit();this.prevBoundingClientRect=n});e.observe(this.elementRef.nativeElement)})})})}ngOnDestroy(){this.editor&&this.editor.destroy()}reInit(){setTimeout(()=>{this.ngOnDestroy(),this.ngAfterViewInit()},0)}}return t.\u0275fac=function(n){return new(n||t)(l.Y36(m.oN),l.Y36(u.eN),l.Y36(l.R0b),l.Y36(l.SBq))},t.\u0275cmp=l.Xpm({type:t,selectors:[["tinymce"]],viewQuery:function(t,n){if(1&t&&l.Gf(p,7),2&t){let t;l.iGM(t=l.CRH())&&(n.textarea=t.first)}},inputs:{config:"config",html:"html"},outputs:{inited:"inited",htmlChange:"htmlChange"},features:[l.TTD],decls:2,vars:0,consts:[["textarea",""]],template:function(t,n){1&t&&l._UZ(0,"textarea",null,0)},styles:["[_nghost-%COMP%]{display:block;width:100%}"],changeDetection:0}),t})();var f=e(4453),b=e(9374),z=e(4514),y=e(8542);function Z(t,n){if(1&t&&(l.ynx(0),l._UZ(1,"div",4),l.BQk()),2&t){const t=l.oxw();l.xp6(1),l.Q6J("innerHTML",t.previewHTML,l.oJD)}}let C=(()=>{class t{constructor(t){this.sanitizer=t,this.html="",this.previewHTML="",this.isVisible=!1}ngOnInit(){}preview(){this.isVisible=!0,this.previewHTML=this.sanitizer.bypassSecurityTrustHtml(this.html)}setHtml(){this.html=window.prompt("\u8bf7\u8f93\u5165html\u5b57\u7b26\u4e32: ",'<h1 style="color: #53c0ea;">TinyMCE</h1>')||""}}return t.\u0275fac=function(n){return new(n||t)(l.Y36(d.H7))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-tinymce-base"]],decls:9,vars:4,consts:[[3,"html","htmlChange"],["nz-button","","nzType","default",3,"click"],["nzTitle","\u9884\u89c8",3,"nzVisible","nzFooter","nzWidth","nzVisibleChange","nzOnCancel"],[4,"nzModalContent"],[3,"innerHTML"]],template:function(t,n){1&t&&(l.TgZ(0,"tinymce",0),l.NdJ("htmlChange",function(t){return n.html=t}),l.qZA(),l._UZ(1,"br"),l.TgZ(2,"button",1),l.NdJ("click",function(){return n.preview()}),l._uU(3,"\u9884\u89c8"),l.qZA(),l._uU(4,"\xa0 "),l.TgZ(5,"button",1),l.NdJ("click",function(){return n.setHtml()}),l._uU(6,"\u586b\u5145HTML"),l.qZA(),l.TgZ(7,"nz-modal",2),l.NdJ("nzVisibleChange",function(t){return n.isVisible=t})("nzOnCancel",function(){return n.isVisible=!1}),l.YNc(8,Z,2,1,"ng-container",3),l.qZA()),2&t&&(l.Q6J("html",n.html),l.xp6(7),l.Q6J("nzVisible",n.isVisible)("nzFooter",null)("nzWidth",850))},directives:[g,f.ix,b.dQ,z.w,y.du,y.Hf],encapsulation:2}),t})();var T=e(8058);function w(t,n){if(1&t){const t=l.EpF();l.TgZ(0,"tinymce",4),l.NdJ("htmlChange",function(n){return l.CHM(t),l.oxw(2).html=n}),l.qZA()}if(2&t){const t=l.oxw(2);l.Q6J("html",t.html)}}function v(t,n){if(1&t&&(l.ynx(0),l.YNc(1,w,1,1,"tinymce",3),l.BQk()),2&t){const t=l.oxw();l.xp6(1),l.Q6J("ngIf",t.isVisible)}}let k=(()=>{class t{constructor(t,n){this.http=t,this.msg=n,this.html="",this.loading=!1,this.isVisible=!1}ngOnInit(){}submit(){if(!this.html)return void this.msg.warning("\u8bf7\u8f93\u5165\u5185\u5bb9!");let t={html:this.html};this.loading=!0,this.http.post("/post",t).subscribe(t=>{this.loading=!1,0==t.code&&(this.msg.success("\u64cd\u4f5c\u6210\u529f"),this.isVisible=!1)})}}return t.\u0275fac=function(n){return new(n||t)(l.Y36(u.eN),l.Y36(T.dD))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-tinymce-dialog"]],decls:4,vars:5,consts:[["nz-button","","nzType","default",3,"click"],["nzTitle","\u5bf9\u8bdd\u6846\u4e2d\u7684\u7f16\u8f91\u5668",3,"nzWidth","nzMaskClosable","nzKeyboard","nzVisible","nzOkLoading","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],[3,"html","htmlChange",4,"ngIf"],[3,"html","htmlChange"]],template:function(t,n){1&t&&(l.TgZ(0,"button",0),l.NdJ("click",function(){return n.html="",n.isVisible=!0}),l._uU(1,"\u6253\u5f00\u5bf9\u8bdd\u6846"),l.qZA(),l.TgZ(2,"nz-modal",1),l.NdJ("nzVisibleChange",function(t){return n.isVisible=t})("nzOnCancel",function(){return n.isVisible=!1})("nzOnOk",function(){return n.submit()}),l.YNc(3,v,2,1,"ng-container",2),l.qZA()),2&t&&(l.xp6(2),l.Q6J("nzWidth",850)("nzMaskClosable",!1)("nzKeyboard",!1)("nzVisible",n.isVisible)("nzOkLoading",n.loading))},directives:[f.ix,b.dQ,z.w,y.du,y.Hf,i.O5,g],encapsulation:2}),t})(),_=(()=>{class t{constructor(t){this.http=t,this.html="\u8bf7\u5c1d\u8bd5\u5728\u8fd9\u91cc\u7c98\u8d34\u622a\u56fe",this.config={images_upload_handler:(t,n,e)=>{let i=new FormData,s=t.blob();i.append("file",s),this.http.post("/upload",i).subscribe(t=>{0==t.code&&n(t.data.url)})}}}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(l.Y36(u.eN))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-tinymce-upload"]],decls:1,vars:2,consts:[[3,"html","config","htmlChange"]],template:function(t,n){1&t&&(l.TgZ(0,"tinymce",0),l.NdJ("htmlChange",function(t){return n.html=t}),l.qZA()),2&t&&l.Q6J("html",n.html)("config",n.config)},directives:[g],encapsulation:2}),t})();const A=[{path:"",pathMatch:"full",redirectTo:"index"},{path:"index",component:(()=>{class t{constructor(){}ngOnInit(){}onMdLoad(){let t=location.hash;location.hash="",location.hash=t}nzAnchorClick(t){location.hash=t.slice(1)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-tinymce"]],decls:25,vars:3,consts:[["docPage",""],[3,"nzContainer","nzAffix","nzClick"],["nzHref","#\u57fa\u672c","nzTitle","\u57fa\u672c"],["nzHref","#\u5728\u5bf9\u8bdd\u6846\u4e2d\u4f7f\u7528","nzTitle","\u5728\u5bf9\u8bdd\u6846\u4e2d\u4f7f\u7528"],["nzHref","#\u56fe\u7247\u4e0a\u4f20","nzTitle","\u56fe\u7247\u4e0a\u4f20"],["nzHref","#md-api","nzTitle","API"],["nzHref","#md-\u9ed8\u8ba4\u914d\u7f6e-defaultconfig","nzTitle","\u9ed8\u8ba4\u914d\u7f6e"],[3,"md"],[2,"display","none"],["intro",""],["id","\u57fa\u672c",2,"margin-top","0"],["cardTitle","\u57fa\u672c","codeUrl","./assets/docs/tinymce/tinymce-base.component.ts"],["id","\u5728\u5bf9\u8bdd\u6846\u4e2d\u4f7f\u7528"],["cardTitle","\u5728\u5bf9\u8bdd\u6846\u4e2d\u4f7f\u7528","desc","\u5728\u5bf9\u8bdd\u6846\u4e2d\u4f7f\u7528","codeUrl","./assets/docs/tinymce/tinymce-dialog.component.ts"],["id","\u56fe\u7247\u4e0a\u4f20"],["cardTitle","\u56fe\u7247\u4e0a\u4f20","desc","\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5bf9\u56fe\u7247\u8fdb\u884cbase64\u7f16\u7801, \u4f60\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3","codeUrl","./assets/docs/tinymce/tinymce-upload.component.ts"],["md","./assets/docs/tinymce/api.md",3,"load"]],template:function(t,n){if(1&t&&(l.TgZ(0,"doc-page",null,0),l.TgZ(2,"nz-anchor",1),l.NdJ("nzClick",function(t){return n.nzAnchorClick(t)}),l._UZ(3,"nz-link",2),l._UZ(4,"nz-link",3),l._UZ(5,"nz-link",4),l.TgZ(6,"nz-link",5),l._UZ(7,"nz-link",6),l.qZA(),l.qZA(),l.TgZ(8,"doc-md-preview",7),l.TgZ(9,"textarea",8,9),l._uU(11,'# TinyMCE \n\u5bcc\u6587\u672c\u7ec4\u4ef6, \u57fa\u4e8e <a target="_blank" href="https://www.tiny.cloud/">TinyMCE v5.8.1</a>(<a target="_blank" href="http://tinymce.ax-z.cn">\u4e2d\u6587\u6587\u6863</a>)\n    '),l.qZA(),l.qZA(),l.TgZ(12,"h3",10),l._uU(13,"\u57fa\u672c"),l.qZA(),l.TgZ(14,"example-card",11),l._UZ(15,"app-tinymce-base"),l.qZA(),l.TgZ(16,"h3",12),l._uU(17,"\u5728\u5bf9\u8bdd\u6846\u4e2d\u4f7f\u7528"),l.qZA(),l.TgZ(18,"example-card",13),l._UZ(19,"app-tinymce-dialog"),l.qZA(),l.TgZ(20,"h3",14),l._uU(21,"\u56fe\u7247\u4e0a\u4f20"),l.qZA(),l.TgZ(22,"example-card",15),l._UZ(23,"app-tinymce-upload"),l.qZA(),l.TgZ(24,"doc-md-preview",16),l.NdJ("load",function(){return n.onMdLoad()}),l.qZA(),l.qZA()),2&t){const t=l.MAs(1),n=l.MAs(10);l.xp6(2),l.Q6J("nzContainer",t.page)("nzAffix",!1),l.xp6(6),l.Q6J("md",n.value)}},directives:[c.i,a.IT,a.Fp,r.M,h.w,C,k,_],styles:[""]}),t})()}];let x=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[i.ez,o.m,s.Bz.forChild(A)]]}),t})()}}]);